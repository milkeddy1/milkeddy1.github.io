<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>如何在nextjs使用.md</title><meta name="description" content="只專注一件事"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="markdown files in Nextjs.MDX其實依照Nextjs官網的solution，他有一個方式可以去讀一個叫做.mdx的檔案格式
他和.md幾乎是一樣的，但是他能做的事情不只是寫markdown
他可以在裡面寫javascript，把需要的component import進去
e.g.
12345678910111213import &amp;#123; MyComponent &amp;#125; from &amp;#x27;my-components&amp;#x27;# My MDX pageThis is a list in markdown:- One- Two- ThreeCheckout my React component:&amp;lt;MyComponent/&amp;gt;

如何實作 ?如何讀這些.md檔案?我.."><meta name="generator" content="Hexo 7.3.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Eddy's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">如何在nextjs使用.md</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#markdown-files-in-Nextjs"><span class="toc-text">markdown files in Nextjs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MDX"><span class="toc-text">.MDX</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AF%A6%E4%BD%9C"><span class="toc-text">如何實作 ?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%80%E9%80%99%E4%BA%9B-md%E6%AA%94%E6%A1%88"><span class="toc-text">如何讀這些.md檔案?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8nextjs%E4%BD%BF%E7%94%A8fs%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91"><span class="toc-text">在nextjs使用fs遇到的坑</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#process-cwd-vs-dirname"><span class="toc-text">process.cwd() vs __dirname</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E6%8B%BF%E5%88%B0%E7%9A%84md%E8%B3%87%E6%96%99"><span class="toc-text">解析拿到的md資料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A3%E5%BC%8F"><span class="toc-text">樣式</span></a></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/frontend"><i class="tag post-item-tag">frontend</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">如何在nextjs使用.md</h1><time class="has-text-grey" datetime="2023-04-04T16:00:00.000Z">2023-04-05</time><article class="mt-2 post-content"><h1 id="markdown-files-in-Nextjs"><a href="#markdown-files-in-Nextjs" class="headerlink" title="markdown files in Nextjs"></a>markdown files in Nextjs</h1><h3 id="MDX"><a href="#MDX" class="headerlink" title=".MDX"></a>.MDX</h3><p>其實依照Nextjs官網的solution，他有一個方式可以去讀一個叫做.mdx的檔案格式</p>
<p>他和.md幾乎是一樣的，但是他能做的事情不只是寫markdown</p>
<p>他可以在裡面寫javascript，把需要的component import進去</p>
<p>e.g.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import &#123; MyComponent &#125; from &#x27;my-components&#x27;</span><br><span class="line"></span><br><span class="line"># My MDX page</span><br><span class="line"></span><br><span class="line">This is a list in markdown:</span><br><span class="line"></span><br><span class="line">- One</span><br><span class="line">- Two</span><br><span class="line">- Three</span><br><span class="line"></span><br><span class="line">Checkout my React component:</span><br><span class="line"></span><br><span class="line">&lt;MyComponent/&gt;</span><br></pre></td></tr></table></figure>

<h2 id="如何實作"><a href="#如何實作" class="headerlink" title="如何實作 ?"></a>如何實作 ?</h2><h3 id="如何讀這些-md檔案"><a href="#如何讀這些-md檔案" class="headerlink" title="如何讀這些.md檔案?"></a>如何讀這些.md檔案?</h3><p>我在&#x2F;src資料夾裡面加了一folder叫做<code>posts</code></p>
<p>在posts裡面新增markdown files</p>
<p>然後會在pages的 <code>getServerSideProps</code> function去讀fs檔案</p>
<p>利用<code>fs</code>module裡面的<code>readdirSync</code>和<code>readdirSync</code>function去讀files和folder</p>
<p>如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">export const getServerSideProps = async () =&gt; &#123;</span><br><span class="line">  const files = fs.readdirSync(path.resolve(process.cwd(), &quot;src/posts&quot;));</span><br><span class="line">  const allPostsData = files.map((fileName) =&gt; &#123;</span><br><span class="line">    const slug = fileName.replace(&quot;.md&quot;, &quot;&quot;);</span><br><span class="line">    const fileContents = fs.readFileSync(</span><br><span class="line">      path.resolve(process.cwd(), `src/posts/$&#123;slug&#125;.md`</span><br><span class="line">      ));</span><br><span class="line">    const &#123; data, content &#125; = matter(fileContents);</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      files,</span><br><span class="line">      slug,</span><br><span class="line">      data,</span><br><span class="line">      content,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">  return &#123; props: &#123; allPostsData &#125; &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="在nextjs使用fs遇到的坑"><a href="#在nextjs使用fs遇到的坑" class="headerlink" title="在nextjs使用fs遇到的坑"></a>在nextjs使用fs遇到的坑</h3><h4 id="process-cwd-vs-dirname"><a href="#process-cwd-vs-dirname" class="headerlink" title="process.cwd() vs __dirname"></a>process.cwd() vs __dirname</h4><p>對於node不是很熟悉的我來說，即使是google到答案還不是很確定為什麼XD</p>
<p>我要去閱讀 <code>path.resolve(process.cwd(), &quot;src/posts&quot;)</code>這個位置的檔案</p>
<p>一開始都一直失敗，因為我第一個參數用的是<code>__dirname</code>，一直不知道為何</p>
<p>但這和next執行node的方式有關</p>
<p>先講一下__dirname和process.cwd()的差異</p>
<p>前者是<strong>執行node的檔案位置</strong>，以我的案例來說，因為我是在getServerSideProps執行</p>
<p><img src="/images/2.png" alt="image"></p>
<p>有上圖可以看到，因為是在server執行的，所以會抓到.next\server\pages這個路徑，而找不到我的.md檔案</p>
<h3 id="解析拿到的md資料"><a href="#解析拿到的md資料" class="headerlink" title="解析拿到的md資料"></a>解析拿到的md資料</h3><p>會需要一個叫做 next-mdx-remote 這個套件來解析markdown file</p>
<p>會需要import一個component和function分別是MDXRemote和serialize</p>
<p>serialize function會回傳一個promise，response會回傳一個物件</p>
<p>再把這個物件放到MDXRemote component裡面</p>
<h3 id="樣式"><a href="#樣式" class="headerlink" title="樣式"></a>樣式</h3><p>以我這個專案用tailwind來說</p>
<p>tailwind有給一個className可以diabled掉指定的component <code>prose</code></p>
<p>在tailwind.config裡面去設定我想要的markdown樣式</p>
<p><a href="https://tailwindcss.com/docs/typography-plugin" target="_blank">參考如連結</a></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2023/04/07/10/" title="為什麼React map時需要加上key?"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: 為什麼React map時需要加上key?</span></a><a class="button is-default" href="/2023/04/03/8/" title="如何更改commit message ?"><span class="has-text-weight-semibold">Next: 如何更改commit message ?</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/myBlogRepo" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/milkeddy1"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com/milkeddy1"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Eddy 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>