<!DOCTYPE html><html class="appearance-dark" lang="en"><head><meta charset="UTF-8"><title>為什麼React map時需要加上key?</title><meta name="description" content="只專注一件事"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="React key的用途作為使用React開發網頁的開發者
必定會用到這個語法
12345function Mycomponent() &amp;#123;   return &amp;lt;&amp;gt;    &amp;#123;arr.map(item=&amp;gt;&amp;lt;div key=&amp;#123;item.id&amp;#125;&amp;gt;&amp;#123;item.name&amp;#125;&amp;lt;/div&amp;gt;)&amp;#125;  &amp;lt;/&amp;gt;&amp;#125;

React官方網站寫說: Keys tell React which array item each component corresponds to.
對React來講，key就是辨識array裡面每一個item的一個標示
他以資料夾做舉例，你要對資料夾新增刪除，電腦會提示你給他一個名稱.."><meta name="generator" content="Hexo 7.3.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Eddy's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">為什麼React map時需要加上key?</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#React-key%E7%9A%84%E7%94%A8%E9%80%94"><span class="toc-text">React key的用途</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A6%81%E6%80%8E%E9%BA%BC%E7%B5%A6key-%E4%B8%8D%E7%B5%A6%E6%9C%83%E6%80%8E%E6%A8%A3-%E9%9B%A3%E9%81%93react%E5%B0%B1%E7%84%A1%E6%B3%95%E8%BE%A8%E8%AD%98%E6%AF%8F%E5%80%8Barray-item"><span class="toc-text">要怎麼給key ? 不給會怎樣 難道react就無法辨識每個array item ?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B5%A6index%E6%9C%83%E7%99%BC%E7%94%9F%E4%BB%80%E9%BA%BC%E5%95%8F%E9%A1%8C"><span class="toc-text">給index會發生什麼問題 ?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E8%83%BD%E5%95%8F%E9%A1%8C"><span class="toc-text">效能問題</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%84%A1%E6%B3%95%E9%A0%90%E6%9C%9F%E7%9A%84%E9%8C%AF%E8%AA%A4"><span class="toc-text">無法預期的錯誤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E4%BB%A5%E7%94%A8index%E4%BD%9C%E7%82%BAkey%E7%9A%84%E6%99%82%E6%A9%9F"><span class="toc-text">可以用index作為key的時機</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/frontend"><i class="tag post-item-tag">frontend</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">為什麼React map時需要加上key?</h1><time class="has-text-grey" datetime="2023-04-06T16:00:00.000Z">2023-04-07</time><article class="mt-2 post-content"><h1 id="React-key的用途"><a href="#React-key的用途" class="headerlink" title="React key的用途"></a>React key的用途</h1><p>作為使用React開發網頁的開發者</p>
<p>必定會用到這個語法</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Mycomponent</span></span>() &#123; </span><br><span class="line">  <span class="built_in">return</span> &lt;&gt;</span><br><span class="line">    &#123;arr.map(item=&gt;&lt;div key=&#123;item.id&#125;&gt;&#123;item.name&#125;&lt;/div&gt;)&#125;</span><br><span class="line">  &lt;/&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>React官方網站寫說: <code>Keys tell React which array item each component corresponds to.</code></p>
<p>對React來講，key就是辨識array裡面每一個item的一個標示</p>
<p>他以資料夾做舉例，你要對資料夾新增刪除，電腦會提示你給他一個名稱而且不能重複</p>
<p>這對電腦來講就是他的key，電腦才知道要編輯、刪除、修改的是哪一個東西</p>
<h1 id="要怎麼給key-不給會怎樣-難道react就無法辨識每個array-item"><a href="#要怎麼給key-不給會怎樣-難道react就無法辨識每個array-item" class="headerlink" title="要怎麼給key ? 不給會怎樣 難道react就無法辨識每個array item ?"></a>要怎麼給key ? 不給會怎樣 難道react就無法辨識每個array item ?</h1><p>如上述所說，key像是資料夾名稱必須是unique的，因此我們在map的時候會給他唯一的key值</p>
<p>而要注意到的是，他不是只整個react application唯一，而是該array唯一</p>
<p>一般來說，在處理array類型資料的時候都會有對應的id，我們會把這個id當作key</p>
<p>但不一定要是id，也可能是name, title這種可能會是unique值的東西</p>
<p>如果真的重複，react也會貼心地跟你講</p>
<p>–</p>
<p>!! 錯誤的情況</p>
<ul>
<li>就是你可能給了key，但是它是有重複的，react就會報錯</li>
<li>或者是用map第二個參數index給key，這個方式在一般情況可能沒問題，但是有機會發生無法預期的錯誤</li>
<li>不給key，根據react官網，他會一樣default給你index</li>
</ul>
<h2 id="給index會發生什麼問題"><a href="#給index會發生什麼問題" class="headerlink" title="給index會發生什麼問題 ?"></a>給index會發生什麼問題 ?</h2><h3 id="效能問題"><a href="#效能問題" class="headerlink" title="效能問題"></a>效能問題</h3><p>使用index作為key，如果做新增、刪除array的操作，對react來講每一次都在重新給予key值</p>
<p>假設有一個array</p>
<p>item 1-3對應的index key是 0, 1, 2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#x27;item1&#x27;, &#x27;item2&#x27;, &#x27;item3&#x27;]</span><br></pre></td></tr></table></figure>

<p>如果我把’item2’刪掉，那這個array index只剩下 1, 2，那item3就被重新給予key了</p>
<p>如果有一個非常龐大的array，每次操作他都會重新render，可以想像會對效能造成不小的傷害</p>
<h3 id="無法預期的錯誤"><a href="#無法預期的錯誤" class="headerlink" title="無法預期的錯誤"></a>無法預期的錯誤</h3><p>如下圖例子，刪除第二項，input內容卻被保留了</p>
<p><img src="/images/post3.png" alt="image"><br><img src="/images/post3-1.png" alt="image"></p>
<h2 id="可以用index作為key的時機"><a href="#可以用index作為key的時機" class="headerlink" title="可以用index作為key的時機"></a>可以用index作為key的時機</h2><p>在靜態頁面的情況，非常確定不會操作到array的時候其實就可以用index</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2023/04/16/11/" title="nginx, Dockerfile, docker compose"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: nginx, Dockerfile, docker compose</span></a><a class="button is-default" href="/2023/04/05/9/" title="如何在nextjs使用.md"><span class="has-text-weight-semibold">Next: 如何在nextjs使用.md</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/myBlogRepo" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/milkeddy1"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com/milkeddy1"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Eddy 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>